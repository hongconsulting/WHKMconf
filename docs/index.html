<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Kaplan-Meier confidence intervals and confidence bands • WHKMconf</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Kaplan-Meier confidence intervals and confidence bands">
<meta name="description" content="This package re-implements selected pointwise confidence intervals and simultaneous confidence bands for Kaplan-Meier survival estimates from the the km.ci package and from the work of Sachs, Brand, and Gabriel (DOI:10.1038/s41416-022-01920-5) for improved performance. The implemented Nair confidence bands allows arbitrary confidence levels rather than being restricted to pre-computed tables of critical values. The implemented Thomas–Grunkemeier confidence intervals maintain numerical stability at extremely small alpha values that may arise during the construction of Hollander–McKeague confidence bands. WH code is designed to maximise speed, for use in simulation studies. As such, input validation is minimal and the user is responsible for ensuring valid use.">
<meta property="og:description" content="This package re-implements selected pointwise confidence intervals and simultaneous confidence bands for Kaplan-Meier survival estimates from the the km.ci package and from the work of Sachs, Brand, and Gabriel (DOI:10.1038/s41416-022-01920-5) for improved performance. The implemented Nair confidence bands allows arbitrary confidence levels rather than being restricted to pre-computed tables of critical values. The implemented Thomas–Grunkemeier confidence intervals maintain numerical stability at extremely small alpha values that may arise during the construction of Hollander–McKeague confidence bands. WH code is designed to maximise speed, for use in simulation studies. As such, input validation is minimal and the user is responsible for ensuring valid use.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">WHKMconf</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/hongconsulting/WHKMconf/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="whkmconf">WHKMconf<a class="anchor" aria-label="anchor" href="#whkmconf"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>This package re-implements selected pointwise confidence intervals and simultaneous confidence bands for Kaplan-Meier survival estimates from the the <code>km.ci</code> package and from the work of <a href="https://doi.org/10.1038/s41416-022-01920-5" class="external-link">Sachs, Brand, and Gabriel</a> for improved performance. Differences compared to <code>km.ci</code> include:</p>
<ul>
<li><p>Nair confidence bands allows arbitrary confidence levels rather than being restricted to pre-computed tables of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>e</mi><mi>α</mi></msub><annotation encoding="application/x-tex">e_\alpha</annotation></semantics></math> critical values.</p></li>
<li><p>Thomas–Grunkemeier confidence intervals maintain numerical stability at extremely small <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math> values that may arise during the construction of Hollander–McKeague confidence bands.</p></li>
</ul>
<p>‘WH’ code is designed to maximise speed, for use in simulation studies. As such, input validation is minimal and the user is responsible for ensuring valid use.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of WHKMconf from <a href="https://github.com/hongconsulting/WHKMconf" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"hongconsulting/WHKMconf"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hongconsulting/WHKMconf" class="external-link">WHKMconf</a></span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"time"</span> <span class="op">=</span> <span class="fu">survival</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/survival/man/ovarian.html" class="external-link">ovarian</a></span><span class="op">$</span><span class="va">futime</span>, <span class="st">"status"</span> <span class="op">=</span> <span class="fu">survival</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/survival/man/ovarian.html" class="external-link">ovarian</a></span><span class="op">$</span><span class="va">fustat</span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit</a></span><span class="op">(</span><span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span> <span class="op">*</span> <span class="fl">12</span> <span class="op">/</span> <span class="fl">365.2425</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span></span>
<span><span class="va">CI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"time"</span> <span class="op">=</span> <span class="va">s</span><span class="op">$</span><span class="va">time</span>, <span class="st">"surv"</span> <span class="op">=</span> <span class="va">s</span><span class="op">$</span><span class="va">surv</span><span class="op">)</span></span>
<span><span class="va">CI.R</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="reference/WH_Rothman.html">WH_Rothman</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">surv</span>, <span class="va">s</span><span class="op">$</span><span class="va">n.risk</span>, <span class="va">s</span><span class="op">$</span><span class="va">n.event</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">CI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">CI</span>, <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="va">CI.R</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rl"</span>, <span class="st">"Ru"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">CI.TG</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="reference/WH_ThomasGrunkemeier.html">WH_ThomasGrunkemeier</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">time</span>, <span class="va">s</span><span class="op">$</span><span class="va">n.risk</span>, <span class="va">s</span><span class="op">$</span><span class="va">n.event</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">CI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">CI</span>, <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="va">CI.TG</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TGl"</span>, <span class="st">"TGu"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">CI.N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="reference/WH_Nair.html">WH_Nair</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">time</span>, <span class="va">s</span><span class="op">$</span><span class="va">surv</span>, <span class="va">s</span><span class="op">$</span><span class="va">std.err</span>, <span class="va">s</span><span class="op">$</span><span class="va">n.risk</span>, <span class="va">s</span><span class="op">$</span><span class="va">n.event</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">CI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">CI</span>, <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="va">CI.N</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Nl"</span>, <span class="st">"Nu"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">CI.HM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="reference/WH_HollanderMcKeague.html">WH_HollanderMcKeague</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">time</span>, <span class="va">s</span><span class="op">$</span><span class="va">n.risk</span>, <span class="va">s</span><span class="op">$</span><span class="va">n.event</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">CI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">CI</span>, <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="va">CI.HM</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HMl"</span>, <span class="st">"HMu"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">t_max</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">time</span> <span class="op">*</span> <span class="fl">12</span><span class="op">/</span><span class="fl">365.2425</span><span class="op">)</span></span>
<span><span class="va">t_eventmax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">time</span><span class="op">[</span><span class="va">data</span><span class="op">$</span><span class="va">status</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="fl">12</span><span class="op">/</span><span class="fl">365.2425</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">CI</span><span class="op">$</span><span class="va">time</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">t_max</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">CI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">CI</span>, <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">CI</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">CI</span><span class="op">$</span><span class="va">time</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">CI</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">t_max</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>cex <span class="op">=</span> <span class="fl">1</span>, las <span class="op">=</span> <span class="fl">1</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">CI</span><span class="op">$</span><span class="va">time</span>, y <span class="op">=</span> <span class="va">CI</span><span class="op">$</span><span class="va">surv</span>, type <span class="op">=</span> <span class="st">"s"</span>, xaxs <span class="op">=</span> <span class="st">"i"</span>, yaxs <span class="op">=</span> <span class="st">"i"</span>, xaxt <span class="op">=</span> <span class="st">"n"</span>, yaxt <span class="op">=</span> <span class="st">"n"</span>, xlab <span class="op">=</span> <span class="st">"Time (months)"</span>, ylab <span class="op">=</span> <span class="st">"Overall survival"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">t_max</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">t_max</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.25</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">CI</span><span class="op">$</span><span class="va">Rl</span>, x <span class="op">=</span> <span class="va">CI</span><span class="op">$</span><span class="va">time</span>, type <span class="op">=</span> <span class="st">"s"</span>, lty <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">CI</span><span class="op">$</span><span class="va">Ru</span>, x <span class="op">=</span> <span class="va">CI</span><span class="op">$</span><span class="va">time</span>, type <span class="op">=</span> <span class="st">"s"</span>, lty <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">CI</span><span class="op">$</span><span class="va">TGl</span>, x <span class="op">=</span> <span class="va">CI</span><span class="op">$</span><span class="va">time</span>, type <span class="op">=</span> <span class="st">"s"</span>, lty <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.75</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">CI</span><span class="op">$</span><span class="va">TGu</span>, x <span class="op">=</span> <span class="va">CI</span><span class="op">$</span><span class="va">time</span>, type <span class="op">=</span> <span class="st">"s"</span>, lty <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.75</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/clip.html" class="external-link">clip</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="fl">0</span>, y1 <span class="op">=</span> <span class="fl">0</span>, x2 <span class="op">=</span> <span class="va">t_eventmax</span>, y2 <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">CI</span><span class="op">$</span><span class="va">Nl</span>, x <span class="op">=</span> <span class="va">CI</span><span class="op">$</span><span class="va">time</span>, type <span class="op">=</span> <span class="st">"s"</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.75</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">CI</span><span class="op">$</span><span class="va">Nu</span>, x <span class="op">=</span> <span class="va">CI</span><span class="op">$</span><span class="va">time</span>, type <span class="op">=</span> <span class="st">"s"</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.75</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/clip.html" class="external-link">clip</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="fl">0</span>, y1 <span class="op">=</span> <span class="fl">0</span>, x2 <span class="op">=</span> <span class="va">t_max</span>, y2 <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">CI</span><span class="op">$</span><span class="va">HMl</span>, x <span class="op">=</span> <span class="va">CI</span><span class="op">$</span><span class="va">time</span>, type <span class="op">=</span> <span class="st">"s"</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">CI</span><span class="op">$</span><span class="va">HMu</span>, x <span class="op">=</span> <span class="va">CI</span><span class="op">$</span><span class="va">time</span>, type <span class="op">=</span> <span class="st">"s"</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rothman"</span>, <span class="st">"Thomas\u2013Grunkemeier"</span>, <span class="st">"Nair"</span>, <span class="st">"Hollander\u2013McKeague"</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.75</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>               <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.75</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       bty <span class="op">=</span> <span class="st">"n"</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, inset <span class="op">=</span> <span class="fl">0</span>, ncol <span class="op">=</span> <span class="fl">2</span>,</span>
<span>       x <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yjust <span class="op">=</span> <span class="fl">0</span>, xpd <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-2-1.png"><!-- --></p>
</div>
<div class="section level2">
<h2 id="further-reading">Further Reading<a class="anchor" aria-label="anchor" href="#further-reading"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Borokov, A.A. and Sycheva, N.M., 1968. On asymptotically optimal non-parametric criteria. <em>Theory of Probability &amp; Its Applications</em>, 13(3), pp. 359–393.</li>
<li>Hall, W.J. and Wellner, J.A., 1980. Confidence bands for a survival curve from censored data. <em>Biometrika</em>, 67(1), pp. 133–143.</li>
<li>Hollander, M. and McKeague, I.W., 1997. Likelihood ratio-based confidence bands for survival functions. <em>Journal of the American Statistical Association</em>, 92(437), pp. 215–226.</li>
<li>Klein, J.P. and Moeschberger, M.L., 2003. Appendix C: Statistical Tables. In <em>Survival Analysis: Techniques for Censored and Truncated Data</em>, pp. 455–482. New York: Springer New York.</li>
<li>Nair, V.N., 1984. Conﬁdence bands for survival functions with censored data: a comparative study. <em>Technometrics</em>, 26, pp. 265–275.</li>
<li>Rothman, K.J., 1978. Estimation of confidence limits for the cumulative probability of survival in life table analysis. <em>Journal of Chronic Diseases</em>, 31(8), pp. 557–560.</li>
<li>Sachs, M.C., Brand, A. and Gabriel, E.E., 2022. Confidence bands in survival analysis. <em>British Journal of Cancer</em>, 127(9), pp. 1636–1641.</li>
<li>Thomas, D.R. and Grunkemeier, G.L., 1975. Confidence interval estimation of survival probabilities for censored data. <em>Journal of the American Statistical Association</em>, 70(352), pp. 865–871.</li>
</ol>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/hongconsulting/WHKMconf/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/hongconsulting/WHKMconf/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing WHKMconf</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Wei Hong <br><small class="roles"> Author, maintainer </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Wei Hong.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
